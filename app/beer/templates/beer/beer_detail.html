{% extends "base.html" %}

{% block title %}{{ beer.name }}{% endblock %}

{% block content %}
  <div class="container">
    <h1>{{ beer.name }}</h1>
    <p><a href="{% url 'brewery:brewery_detail' brewery.pk %}">{{ brewery.name }}</a></p>
    <p>Type: {{ beer.type }}</p>
    <p>Style: {{ beer.style }}</p>
    <p>ABV: {{ beer.abv }}</p>
    <p>IBU: {{ beer.ibu }}</p>
    <p>Color: {% if beer.color %}{{ beer.color }}{% else %}Unknown{% endif %}</p>
    <p>Description: {% if beer.description %}{{ beer.description }}{% else %}None{% endif %}</p>

    <h2>Favorite</h2>
    {% if user.is_authenticated %}
          {% if user.is_authenticated %}
            <a href="{% url 'beer:image_create' beer.pk %}" class="btn btn-warning">
              <i class="bi bi-card-image"></i> Add Image
            </a>
            <a href="{% url 'beer:review_create' beer.pk %}" class="btn btn-warning">
              <i class="bi bi-card-text"></i> Leave Review
            </a>
            <button id="favorite" data-pk="{{ beer.pk }}" class="btn btn-warning">{% if favorite %}<i class="bi bi-star-fill"></i> Remove Favorite{% else %}<i class="bi bi-star"></i> Add Favorite{% endif %}</button>
          {% else %}
            <button class="btn btn-outline-warning disabled">Add Image</button>
    {% endif %}

    <h2>Images</h2>
    {% if images %}
      <p><a href="{% url 'beer:image_create' beer.pk %}">Submit an image</a></p>
      {% for image in images %}
        <img src="{{ image.image.url }}" alt="{{ image.beer.name }} by {{ image.user.username }}">
      {% endfor %}
    {% else %}
      <p>No images yet. Submit one <a href="{% url 'beer:image_create' beer.pk %}">here.</a></p>
    {% endif %}

    <h2>Reviews</h2>
    {% if reviews %}
      <p><a href="{% url 'beer:review_create' beer.pk %}">Submit a review</a></p>
      <ul>
        {% for review in reviews %}
          <li>Rated {{ review.rating }} by <a href="{% url 'user:user_detail' review.user.pk %}">{{ review.user.username }}</a> on {{ review.created_at.date }}: {{ review.text }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No reviews yet. Submit one <a href="{% url 'beer:review_create' beer.pk %}">here.</a></p>
    {% endif %}

    <h2>Similar</h2>
    {% if similar %}
      <ul>
      {% for beer in similar %}
        <li><a href="{% url 'beer:beer_detail' beer.pk %}">{{ beer.name }}</a> by <a href="{% url 'brewery:brewery_detail' beer.brewery.pk %}">{{ beer.brewery.name }}</a></li>
      {% endfor %}
      </ul>
    {% else %}
      <p>No similar beers found.</p>
    {% endif %}
  </div>
{% endblock %}